if("undefined"==typeof jQuery.ccjs)throw new Error("Please include the ccjs initializer file");if("undefined"==typeof moment)throw new Error("The ccjs datepicker plugin requires moment.js");!function(a){var b='<div class="slds-dropdown slds-dropdown--left slds-datepicker" aria-hidden="false" data-selection="single"><div class="slds-datepicker__filter slds-grid"><div class="slds-datepicker__filter--month slds-grid slds-grid--align-spread slds-size--3-of-4"><div class="slds-align-middle"><button id="ccjs-prevButton" class="slds-button slds-button--icon-container"><svg aria-hidden="true" class="slds-button__icon slds-button__icon--small"><use xlink:href="{{assetsLocation}}/assets/icons/utility-sprite/svg/symbols.svg#left"></use><i class="fa fa-fw">\uf0d9</i></svg><span class="slds-assistive-text">Previous Month</span></button></div><h2 id="month" class="slds-align-middle" aria-live="assertive" aria-atomic="true"></h2><div class="slds-align-middle"><button id="ccjs-nextButton" class="slds-button slds-button--icon-container"><svg aria-hidden="true" class="slds-button__icon slds-button__icon--small"><use xlink:href="{{assetsLocation}}/assets/icons/utility-sprite/svg/symbols.svg#right"></use></svg><span class="slds-assistive-text">Next Month</span></button></div></div><div class="slds-form-element"><div class="slds-form-element__control"><div class="slds-picklist datepicker__filter--year slds-shrink-none"></div></div></div></div>',c='<table class="datepicker__month" role="grid" aria-labelledby="month"><thead><tr id="weekdays"><th id="Sunday"><abbr title="Sunday">S</abbr></th><th id="Monday"><abbr title="Monday">M</abbr></th><th id="Tuesday"><abbr title="Tuesday">T</abbr></th><th id="Wednesday"><abbr title="Wednesday">W</abbr></th><th id="Thursday"><abbr title="Thursday">T</abbr></th><th id="Friday"><abbr title="Friday">F</abbr></th><th id="Saturday"><abbr title="Saturday">S</abbr></th></tr></thead><tbody></tbody></table></div>',d=function(d,e){this.$el=a(d);var f=moment(e.initDate)||moment(),g=e.endDateInputId;this.$datepickerEl=a(b.replace(/{{assetsLocation}}/g,e.assetsLocation)+c),this.settings=e,e.initDate&&this.setSelectedFullDate(f),g&&1===a("#"+g).length&&(this.$elEndDate=a("#"+g),e.endDate&&this.setEndFullDate(endDate)),this.initInteractivity()};d.prototype={constructor:d,initInteractivity:function(){var b=this,c=this.$datepickerEl,d=this.$el,e=this.$elEndDate||[],f=function(f){if(f.stopPropagation(),a("[data-ccjs-datepicker-id]").not(this).each(function(){a(this).data("datepicker").closeDatepicker()}),f.target===d[0]&&null!==d.val()&&""!==d.val()||f.target===e[0]&&null!==e.val()&&""!==e.val())b.$selectedInput=a(this).parent().find("input"),b.$selectedInput.on("keyup",b,b.processKeyup).on("blur",b,b.processBlur),b.closeDatepicker();else{var g=b.selectedFullDate||moment();b.viewedMonth=g.month(),b.viewedYear=g.year(),b.fillMonth(),b.$selectedInput=a(this).parent().find("input"),b.$selectedInput.off("keyup").off("blur"),b.$selectedInput.closest(".slds-form-element").append(c),b.initYearDropdown(),a([d,c,e,d.prev("svg")]).each(function(){a(this).on("click",b.blockClose)}),c.on("click",b,b.processClick),b.$selectedInput.blur(),a("body").on("click",b,b.closeDatepicker)}};a(d).on("focus",f),a(d.prev("svg")).on("click",f),d.prev("svg").css("cursor","pointer"),e.length>0&&(a(e).on("focus",f),a(e.prev("svg")).on("click",f),e.prev("svg").css("cursor","pointer"))},fillMonth:function(){var b=this.settings.dayLabels,c=this.getMonthArray(),d=a("<tbody>"),e=this.$elEndDate&&this.$elEndDate.length>0;this.selectedFullDate,this.selectedEndDate,c.forEach(function(c){var f=a("<tr>").appendTo(d);c.hasMultiRowSelection&&f.addClass("slds-has-multi-row-selection"),c.data.forEach(function(c,d){var g=a('<td data-ccjs-date="'+c.dateValue+'">').appendTo(f);g.prop({headers:b[d].full,role:"gridcell"}),a('<span class="slds-day">'+c.value+"</span>").appendTo(g),c.isCurrentMonth||(g.addClass("slds-disabled-text"),g.prop("aria-disabled","true")),c.isSelected||c.isSelectedEndDate||c.isSelectedMulti?(g.prop("aria-selected","true"),g.addClass(e?"slds-is-selected-multi slds-is-selected":"slds-is-selected")):g.prop("aria-selected","false"),c.isToday&&g.addClass("slds-is-today")})}),this.$datepickerEl.find("tbody").replaceWith(d),this.$datepickerEl.find("#month").text(this.settings.monthLabels[this.viewedMonth].full),this.$datepickerEl.find("#ccjs-year").text(this.viewedYear)},initYearDropdown:function(){var b=this,c=this.$datepickerEl.find("select"),d=this.viewedYear;if(c.length>0)c.val(this.viewedYear);else{var e=a("<label></label>");c=a('<select class="slds-select select picklist__label">').appendTo(e);for(var f=moment().year(),g=f-this.settings.numYearsBefore;g<=f+this.settings.numYearsAfter;g++)a('<option value="'+g+'">'+g+"</option>").appendTo(c);c.val(d),this.$datepickerEl.find(".datepicker__filter--year").append(e)}c.on("change",function(c){b.viewedYear=a(c.target).val(),b.fillMonth()})},getMMDDYYYY:function(a,b,c){return(a>9?a:"0"+a)+"/"+(b>9?b:"0"+b)+"/"+c},getMonthArray:function(){for(var a=this.selectedFullDate,b=this.selectedEndDate,c=(a?a.date():null,a?a.month():null,a?a.year():null,this.viewedMonth),d=this.viewedYear,e=0===c?11:c-1,f=11===c?0:c+1,g=this.getNumDaysInMonth(d,c),h=this.getNumDaysInMonth(d,e),i=(this.getNumDaysInMonth(d,f),new Date(d,c,1).getDay()),j=[],k=[],l=(this.dayLabels,h-(i-1));h>=l;l++){var m=moment(new Date(11===e?d-1:d,e,l));j.push({value:l,dateValue:this.getMMDDYYYY(e+1,l,d),isCurrentMonth:!1,isToday:m.isSame(moment(),"day")})}for(var l=1;g>=l;l++){var m=moment(new Date(d,c,l));j.push({value:l,dateValue:this.getMMDDYYYY(c+1,l,d),isCurrentMonth:!0,isSelected:a&&m.isSame(a,"day"),isSelectedEndDate:b&&m.isSame(b,"day"),isSelectedMulti:a&&b&&(m.isBetween(a,b)||m.isSame(a,"day")||m.isSame(b,"day")),isToday:m.isSame(moment(),"day")})}if(j.forEach(function(a,b,c){if(b%7===0){var d=b>=7&&c[b-1].isSelectedMulti&&a.isSelectedMulti;d&&(k[k.length-1].hasMultiRowSelection=!0),k.push({data:[],hasMultiRowSelection:d})}k[k.length-1].data.push(a)}),k[k.length-1].data.length<7)for(var m=moment(new Date(0===f?d+1:d,f,l)),n=7-k[k.length-1].data.length,l=1;n>=l;l++)k[k.length-1].data.push({value:l,dateValue:this.getMMDDYYYY(f+1,l,0===f?d+1:d),isCurrentMonth:!1,isSelected:a&&m.isSame(a,"day"),isToday:m.isSame(moment(),"day")});return k},setSelectedFullDate:function(a){var b=this.selectedFullDate;this.selectedFullDate=a,this.$el.val(a.format(this.settings.format)),b&&b.isSame(a,"day")||this.settings.onChange(this)},setSelectedEndDate:function(a){var b=this.selectedEndDate;this.selectedEndDate=a,this.$elEndDate.val(a.format(this.settings.format)),b&&b.isSame(a,"day")||this.settings.onChange(this)},processClick:function(b){b.preventDefault();var c=b.data,d=a(b.target);d.closest("#ccjs-prevButton").length>0&&c.clickPrev(b),d.closest("#ccjs-nextButton").length>0&&c.clickNext(b),d.closest("td[data-ccjs-date]").length>0&&c.clickDate(b),d.closest("li[data-ccjs-year]").length>0&&c.clickYear(b)},processKeyup:function(b){13===b.keyCode&&a(this).blur()},processBlur:function(b){if(b){var c=b.data,d=a(this).val(),e=moment(d,c.settings.format);e.isValid()&&(c.$elEndDate&&c.$elEndDate.length>0&&c.$elEndDate[0]===c.$selectedInput[0]?c.setSelectedEndDate(e):c.setSelectedFullDate(e),c.closeDatepicker(b),c.$selectedInput.off("keyup").off("blur"))}},clickPrev:function(a){var b=a.data;0===b.viewedMonth?(b.viewedMonth=11,b.viewedYear--):b.viewedMonth--,b.fillMonth()},clickNext:function(a){var b=a.data;11===b.viewedMonth?(b.viewedMonth=0,b.viewedYear++):b.viewedMonth++,b.fillMonth()},clickYear:function(b){var c=b.data,d=a(b.target).closest("li[data-ccjs-year]");c.viewedYear=parseInt(d.data("ccjs-year")),c.fillMonth()},clickYearDropdown:function(a){var b=a.data;b.$datepickerEl.find("#ccjs-yearDropdown").length>0?b.hideYearDropdown():b.showYearDropdown()},clickDate:function(b){var c=b.data,d=a(b.target).closest("td[data-ccjs-date]");if(!d.hasClass("slds-disabled-text")){var e=d.data("ccjs-date");c.$elEndDate&&c.$elEndDate.length>0&&c.$elEndDate[0]===c.$selectedInput[0]?c.setSelectedEndDate(moment(e,"MM/DD/YYYY")):c.setSelectedFullDate(moment(e,"MM/DD/YYYY")),c.closeDatepicker(b)}},closeDatepicker:function(b){var c=this,d=a("body");b&&(c=b.data,d=a(this));var e=c.$datepickerEl,f=c.$selectedInput;0===d.closest(c.$el.parent()).length&&f&&(f.closest(".slds-form-element").find(".slds-datepicker").remove(),a("body").unbind("click",c.closeDatepicker),e.unbind("click",c.processClick))},blockClose:function(a){a.stopPropagation()},isLeapYear:function(a){return a%4===0&&a%100!==0||a%400===0},getNumDaysInMonth:function(a,b){return[31,this.isLeapYear(a)?29:28,31,30,31,30,31,31,30,31,30,31][b]},getDate:function(a){return a?this.selectedFullDate.format(a):this.selectedFullDate},setDate:function(a){this.setSelectedFullDate(moment(a))},getEndDate:function(a){return this.$elEndDate&&this.selectedEndDate?a?this.selectedEndDate.format(a):this.selectedEndDate:void 0},setEndDate:function(a){this.$elEndDate&&this.setSelectedEndDate(moment(a))}},a.fn.datepicker=function(b,c){var e,f=a.extend({assetsLocation:a.ccjs.assetsLocation,numYearsBefore:50,numYearsAfter:10,format:"MM/DD/YYYY",endDateInputId:null,onChange:function(a){},dayLabels:[{full:"Sunday",abbv:"S"},{full:"Monday",abbv:"M"},{full:"Tuesday",abbv:"T"},{full:"Wednesday",abbv:"W"},{full:"Thursday",abbv:"T"},{full:"Friday",abbv:"F"},{full:"Saturday",abbv:"S"}],monthLabels:[{full:"January",abbv:""},{full:"February",abbv:""},{full:"March",abbv:""},{full:"April",abbv:""},{full:"May",abbv:""},{full:"June",abbv:""},{full:"July",abbv:""},{full:"August",abbv:""},{full:"September",abbv:""},{full:"October",abbv:""},{full:"November",abbv:""},{full:"December",abbv:""}]},"object"==typeof b?b:{});if(this.each(function(){var g=a(this),h=g.data("datepicker");if(!h){var i=new d(this,f);g.data("datepicker",h=i),g.attr("data-ccjs-datepicker-id",g.attr("id"))}"string"==typeof b&&(e=h[b](c))}),void 0===e||e instanceof d)return this;if(this.length>1)throw new Error("Using only allowed for the collection of a single element ("+option+" function)");return e}}(jQuery);